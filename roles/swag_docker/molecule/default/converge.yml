---
- name: Generate docker-compose.yml on docker remote host
  hosts: all

  pre_tasks:
    - name: Update apt cache.
      ansible.builtin.apt:
        update_cache: "yes"
        cache_valid_time: "600"
      when: ansible_os_family == 'Debian'

  tasks:
    - name: Install python-docker
      ansible.builtin.include_role:
        name: geerlingguy.pip

    - name: Create swag-aws-docker for network lsio-aws
      ansible.builtin.include_role:
        name: swag_docker
      vars:
        ansible_user: root

        swag_docker_remote_repo_path: ~/aws-infra
        swag_docker_purge_config_dir: false
        swag_docker_start_container: false
        swag_docker_tz: America/Chicago
        swag_docker_email: user@example.com
        swag_docker_url: example.com
        swag_docker_container_name: swag-aws
        swag_docker_docker_network: lsio-aws
        swag_docker_check_docker: false
        swag_docker_validation: dns
        swag_docker_dnsplugin: cloudflare
        swag_docker_certprovider: zerossl
        swag_docker_only_subdomains: "true"
        swag_docker_subdomains:
          - pihole
        swag_docker_ports:
          - "0.0.0.0:80:80"
          - "0.0.0.0:443:443"
